##第八章 对象##

Redis并没有直接使用这些数据结构来实现键值对数据库，而是基于这些数据库结构创建了一个对象系统。这个系统包括字符串对象、
列表对象、哈希对象、集合对象和有序集合对象这五种类型的对象。

Redis的对象系统还实现了基于引用计数技术(Reference Counting)的内存回收机制(GC)，当程序不再使用某个对象的时候，这个对象
所占用的内存就会被自动释放。引用计数技术主要是可以实现对象共享机制。这一机制可以在适当的条件下，通过让多个数据库键共享一个对象来节约内存。


Redis使用对象来表示数据库中的键和值，每次当我们在Redis数据库中创建一个键值对时，我们至少会创建两个对象。一个对象用作键值对的键(键对象)，另一个对象用作键值对的值（值对象）。

`Redis> SET msg ""hello world`

键值对的键是一个包含了字符串值msg的对象，键值对的值是一个包含了字符串hello world的对象。

每个对象由redisObject结构表示：

```
typedef struct redisObject{
    unsigned type:4;
    unsigned coding:4;
    void *ptr;
    } robj;
```

因为C语言并不具备自动内存回收的功能，所以Redis在自己的对象系统中构建了一个引用计数(reference counting)技术实现的内存回收机制，通过这一机制，程序可以通过跟踪对象的引用计数信息，在适当的时候自动释放对象并进行内存回收。

Redis会在初始化服务器时，创建一万个字符串对象，这些对象包含了从0到9999的所有整数值，当服务器需要用到值为0到9999的字符串对象时，服务器就会使用这些共享对象，而不是新创建对象。(提前做了这些工作，利用共享机制节省创建对象的时间)。

